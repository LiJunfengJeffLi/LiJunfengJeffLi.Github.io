<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Jeff&#39;s Blog</title>
  
  <subtitle>李俊锋的个人独立博客</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://prophetjeff.com/"/>
  <updated>2017-11-17T08:20:11.362Z</updated>
  <id>http://prophetjeff.com/</id>
  
  <author>
    <name>Jeff Li</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Mysql学习笔记（五）——计算字段与函数</title>
    <link href="http://prophetjeff.com/2017/11/17/mysql-5/"/>
    <id>http://prophetjeff.com/2017/11/17/mysql-5/</id>
    <published>2017-11-17T08:20:00.000Z</published>
    <updated>2017-11-17T08:20:11.362Z</updated>
    
    <content type="html"><![CDATA[<p>　　存储在数据库表中的数据往往都是原始数据，通常它们并非以我们需要的格式展现。比如，城市和邮政编码分别存储在同的列中，但邮件标签打印程序需要将它们作为一个字段（恰当格式）检索出来；物品订单表中分别存储了物品的价格和数量，但为了打印发票需要检索物品的总价格。为了实现上述目标，我们需要直接从数据库中检索出经过计算、转换或者格式化的数据（不能理解为检索出原始数据然后再利用相应软件完成此过程），这就是计算字段。计算字段并不实际存储在数据库表中，而是在运行时于<code>select</code>语句中创建的。</p><p>　　实际上，在SQL语句中完成的许多转换和格式化工作都可以在客户机上许多应用软件来完成，但是一般来说在数据库服务器上完成这些操作要比在客户机中更快（因为DBMS是设计来快速有效完成这种处理的）。<br><a id="more"></a></p><h2 id="1-创建计算字段"><a href="#1-创建计算字段" class="headerlink" title="1. 创建计算字段"></a>1. 创建计算字段</h2><h3 id="1-1-拼接字段"><a href="#1-1-拼接字段" class="headerlink" title="1.1 拼接字段"></a>1.1 拼接字段</h3><ul><li><strong>拼接</strong>（concatenate）：将值连接到一起构成单个值。</li></ul><p>　　首先举一个简单的例子，vendors表中包含供应商名和位置信息。假如现在需要生成一个供应商报表，需要在供应商的名字中按照name(location)这样的格式列出供应商的位置。此报表仅需要单个值，但数据库表中的相应数据存储在vend_name和vend_country中，此外还需要将vend_country用括号括起来。上述要求可以在Mysql的<code>select</code>语句中使用<code>concat()</code>函数来实现拼接这两个列。如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> <span class="keyword">concat</span>(vend_name,<span class="string">'('</span>,vend_country,<span class="string">')'</span>)                 #输入</div><div class="line"><span class="keyword">from</span> vendors</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> vend_name;</div><div class="line">+<span class="comment">----------------------------------------+                    #输出</span></div><div class="line">| concat(vend_name,'(',vend_country,')') |</div><div class="line">+<span class="comment">----------------------------------------+</span></div><div class="line">| ACME(USA)                              |</div><div class="line">| Anvils R Us(USA)                       |</div><div class="line">| Furball Inc.(USA)                      |</div><div class="line">| Jet <span class="keyword">Set</span>(England)                       |</div><div class="line">| Jouets Et Ours(France)                 |</div><div class="line">| LT Supplies(USA)                       |</div><div class="line">+<span class="comment">----------------------------------------+</span></div><div class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.02</span> sec)</div></pre></td></tr></table></figure><p>可见，<code>concat()</code>函数将其括号内的参数进行拼接，各个参数之间由逗号分隔。注意，在数据类型为字符串时容易疏忽掉空格，Mysql提供<code>rtrim()</code>函数和<code>ltrim()</code>函数来分别实现去掉字符串右边和左边的空格。如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> <span class="keyword">concat</span>(<span class="keyword">rtrim</span>(vend_name),<span class="string">'('</span>,<span class="keyword">rtrim</span>(vend_country),<span class="string">')'</span>)                 #输入</div><div class="line"><span class="keyword">from</span> vendors</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> vend_name;</div></pre></td></tr></table></figure><h3 id="1-2-使用别名"><a href="#1-2-使用别名" class="headerlink" title="1.2 使用别名"></a>1.2 使用别名</h3><p>　　从上例可以看出，输出的拼接字段结果实际上是没有名字的，它只是一个值。要在客户机应用中应用该拼接字段或许会出现困难，SQL为了解决这个问题而支持列别名。别名是一个字段或值的替换名，使用<code>as</code>关键字赋予。如下例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> <span class="keyword">concat</span>(vend_name,<span class="string">'('</span>,vend_country,<span class="string">')'</span>) <span class="keyword">as</span> vend_title                 #输入</div><div class="line"><span class="keyword">from</span> vendors</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> vend_name;</div><div class="line">+<span class="comment">------------------------+                                                  #输出</span></div><div class="line">| vend_title             |</div><div class="line">+<span class="comment">------------------------+</span></div><div class="line">| ACME(USA)              |</div><div class="line">| Anvils R Us(USA)       |</div><div class="line">| Furball Inc.(USA)      |</div><div class="line">| Jet <span class="keyword">Set</span>(England)       |</div><div class="line">| Jouets Et Ours(France) |</div><div class="line">| LT Supplies(USA)       |</div><div class="line">+<span class="comment">------------------------+</span></div><div class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p>上述语句本身作用与上一个例子相同，但本语句在计算字段之后跟了<code>as vend_title</code>。它指示SQL创建一个包含指定计算的名为<code>vend_title</code>的计算字段。任何客户机应用都可以按名引用这个列。</p><h3 id="1-3-执行算数计算"><a href="#1-3-执行算数计算" class="headerlink" title="1.3 执行算数计算"></a>1.3 执行算数计算</h3><p>　　除了拼接字段，计算字段的第二种常见用途是对检索的数据进行算数运算。首先来看下面这个例子：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_id, quantity, item_price, quantity*item_price <span class="keyword">as</span> expanded_price #输入</div><div class="line"><span class="keyword">from</span> orderitems</div><div class="line"><span class="keyword">where</span> order_num = <span class="number">20005</span>;</div><div class="line">+<span class="comment">---------+----------+------------+----------------+                        #输出</span></div><div class="line">| prod_id | quantity | item_price | expanded_price |</div><div class="line">+<span class="comment">---------+----------+------------+----------------+</span></div><div class="line">| ANV01   |       10 |       5.99 |          59.90 |</div><div class="line">| ANV02   |        3 |       9.99 |          29.97 |</div><div class="line">| TNT2    |        5 |      10.00 |          50.00 |</div><div class="line">| FB      |        1 |      10.00 |          10.00 |</div><div class="line">+<span class="comment">---------+----------+------------+----------------+</span></div><div class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.15</span> sec)</div></pre></td></tr></table></figure><p>上述语句检索出了订单号为20005的所有物品，并检索出它们的产品ID，产品数量，产品单价和总价。其中产品总价<code>expanded_price</code>为一个计算字段，此计算为<code>quantity*item_price</code>,列别名为<code>expanded_price</code>。如下给出Mysql支持的基本算数操作符，此外圆括号可以用来区分优先顺序：</p><table><thead><tr><th style="text-align:center">操作符</th><th style="text-align:center">说明</th></tr></thead><tbody><tr><td style="text-align:center">+</td><td style="text-align:center">加</td></tr><tr><td style="text-align:center">-</td><td style="text-align:center">减</td></tr><tr><td style="text-align:center">*</td><td style="text-align:center">乘</td></tr><tr><td style="text-align:center">/</td><td style="text-align:center">除</td></tr></tbody></table><p>可以使用<code>select</code>语句测试计算，比如<code>select 2*5;</code>将返回<code>10</code>。</p><h2 id="2-使用数据处理函数"><a href="#2-使用数据处理函数" class="headerlink" title="2. 使用数据处理函数"></a>2. 使用数据处理函数</h2><p>　　同其他计算语言一样，SQL支持利用函数来处理数据，如前面已经用过的<code>concat()</code>函数。函数一般是在数据上执行的，它给数据的转换和处理提供了方便。注意，相比SQL语句函数的可移植性并不强，几乎每种DBMS都支持只适用于本身的函数。因此，在使用函数时最好进行代码注释。大多数SQL实现支持以下类型的函数：</p><ul><li>用于处理文本串的文本函数（如删除、填充或转换值）。</li><li>用于在数值数据上进行算数操作的数值函数（如返回绝对值，进行代数运算）。</li><li>用于处理日期和时间的函数（如返回两个日期差等等）。</li><li>返回DBMS特殊信息的函数（如用户登录信息，版本信息）。</li></ul><h3 id="2-1-文本处理函数"><a href="#2-1-文本处理函数" class="headerlink" title="2.1 文本处理函数"></a>2.1 文本处理函数</h3><table><thead><tr><th style="text-align:center">函数</th><th style="text-align:center">说明</th></tr></thead><tbody><tr><td style="text-align:center">left()</td><td style="text-align:center">返回串左边的字符</td></tr><tr><td style="text-align:center">length()</td><td style="text-align:center">返回串的长度</td></tr><tr><td style="text-align:center">locate()</td><td style="text-align:center">找出串的一个子串</td></tr><tr><td style="text-align:center">lower()</td><td style="text-align:center">将串转换为小写</td></tr><tr><td style="text-align:center">ltrim()</td><td style="text-align:center">去掉串左边的空格</td></tr><tr><td style="text-align:center">right()</td><td style="text-align:center">返回串右边的字符</td></tr><tr><td style="text-align:center">rtrim()</td><td style="text-align:center">去掉串右边的空格</td></tr><tr><td style="text-align:center">soundex()</td><td style="text-align:center">返回串的soundex值</td></tr><tr><td style="text-align:center">substring()</td><td style="text-align:center">返回子串的字符</td></tr><tr><td style="text-align:center">upper()</td><td style="text-align:center">将串转换为大写</td></tr></tbody></table><p>注意，SOUNDEX是一个将任何文本串转换为描述其语音表示的字母数字模式的算法。SOUNDEX考虑了类似的发音字符和音节，使得能对串进行发音比较而不是字母比较。如下例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> cust_name, cust_contact                                              #输入</div><div class="line"><span class="keyword">from</span> customers</div><div class="line"><span class="keyword">where</span> <span class="keyword">soundex</span>(cust_contact) = <span class="keyword">soundex</span>(<span class="string">'Y. Lie'</span>);</div><div class="line">+<span class="comment">-------------+--------------+                                              #输出</span></div><div class="line">| cust_name   | cust_contact |</div><div class="line">+<span class="comment">-------------+--------------+</span></div><div class="line">| Coyote Inc. | Y Lee        |</div><div class="line">+<span class="comment">-------------+--------------+</span></div><div class="line">1 row in <span class="keyword">set</span> (<span class="number">0.09</span> sec)</div></pre></td></tr></table></figure><h3 id="2-2-日期和时间处理函数"><a href="#2-2-日期和时间处理函数" class="headerlink" title="2.2 日期和时间处理函数"></a>2.2 日期和时间处理函数</h3><p>　　日期和时间采用相应的数据类型和特殊的格式存储，以便能快速和有效地排序或过滤，并且节省物理存储空间。一般，应用程序不使用用来存储日期和时间的格式，因此日期和时间函数总是被用来读取、统计和处理这些值。如下是常用的日期和时间处理函数：</p><table><thead><tr><th style="text-align:center">函数</th><th style="text-align:center">说明</th></tr></thead><tbody><tr><td style="text-align:center">adddate()</td><td style="text-align:center">增加一个日期（天、周等）</td></tr><tr><td style="text-align:center">addtime()</td><td style="text-align:center">增加一个时间（时、分等）</td></tr><tr><td style="text-align:center">curdate()</td><td style="text-align:center">返回当前日期</td></tr><tr><td style="text-align:center">curtime()</td><td style="text-align:center">返回当前时间</td></tr><tr><td style="text-align:center">date()</td><td style="text-align:center">返回日期时间的日期部分</td></tr><tr><td style="text-align:center">datediff()</td><td style="text-align:center">计算两个日期之差</td></tr><tr><td style="text-align:center">date_add()</td><td style="text-align:center">高度灵活的日期计算函数</td></tr><tr><td style="text-align:center">date_format()</td><td style="text-align:center">返回一个格式化日期或时间串</td></tr><tr><td style="text-align:center">day()</td><td style="text-align:center">返回一个日期的天数部分</td></tr><tr><td style="text-align:center">day0fweek()</td><td style="text-align:center">对于一个日期，返回对应的星期几</td></tr><tr><td style="text-align:center">hour()</td><td style="text-align:center">返回一个时间的小时部分</td></tr><tr><td style="text-align:center">minute()</td><td style="text-align:center">返回一个时间的分钟部分</td></tr><tr><td style="text-align:center">month()</td><td style="text-align:center">返回一个时间的月份部分</td></tr><tr><td style="text-align:center">now()</td><td style="text-align:center">返回当前日期和时间</td></tr><tr><td style="text-align:center">second()</td><td style="text-align:center">返回一个时间的秒部分</td></tr><tr><td style="text-align:center">time()</td><td style="text-align:center">返回一个日期时间的时间部分</td></tr><tr><td style="text-align:center">year()</td><td style="text-align:center">返回一个日期的年份部分</td></tr></tbody></table><p>注意，在Mysql中使用的日期格式为yyyy-mm-dd，虽然一些其他格式也可行，但这是首选的日期格式（它排除了多义性）。如下例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> cust_id, order_num                                                  #输入</div><div class="line"><span class="keyword">from</span> orders</div><div class="line"><span class="keyword">where</span> <span class="built_in">date</span>(order_date) = <span class="string">'2005-09-01'</span>;</div><div class="line">+<span class="comment">---------+-----------+                                                    #输出</span></div><div class="line">| cust_id | order_num |</div><div class="line">+<span class="comment">---------+-----------+</span></div><div class="line">|   10001 |     20005 |</div><div class="line">+<span class="comment">---------+-----------+</span></div><div class="line">1 row in <span class="keyword">set</span> (<span class="number">0.09</span> sec)</div></pre></td></tr></table></figure><h3 id="2-3-数值处理函数"><a href="#2-3-数值处理函数" class="headerlink" title="2.3 数值处理函数"></a>2.3 数值处理函数</h3><p>　　此类函数仅处理数值函数，一般主要用于代数、三角或几何运算，因此没有串或日期-时间处理函数的使用那么频繁。如下表：</p><table><thead><tr><th style="text-align:center">函数</th><th style="text-align:center">说明</th></tr></thead><tbody><tr><td style="text-align:center">abs()</td><td style="text-align:center">返回一个数的绝对值</td></tr><tr><td style="text-align:center">cos()</td><td style="text-align:center">返回一个角度的余弦</td></tr><tr><td style="text-align:center">exp()</td><td style="text-align:center">返回一个数的指数值</td></tr><tr><td style="text-align:center">mod()</td><td style="text-align:center">返回除法操作的余数</td></tr><tr><td style="text-align:center">pi()</td><td style="text-align:center">返回圆周率</td></tr><tr><td style="text-align:center">rand()</td><td style="text-align:center">返回一个随机数</td></tr><tr><td style="text-align:center">sin()</td><td style="text-align:center">返回一个角度的正弦</td></tr><tr><td style="text-align:center">sqrt()</td><td style="text-align:center">返回一个数的平方根</td></tr><tr><td style="text-align:center">tan()</td><td style="text-align:center">返回一个角度的正切</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;　　存储在数据库表中的数据往往都是原始数据，通常它们并非以我们需要的格式展现。比如，城市和邮政编码分别存储在同的列中，但邮件标签打印程序需要将它们作为一个字段（恰当格式）检索出来；物品订单表中分别存储了物品的价格和数量，但为了打印发票需要检索物品的总价格。为了实现上述目标，我们需要直接从数据库中检索出经过计算、转换或者格式化的数据（不能理解为检索出原始数据然后再利用相应软件完成此过程），这就是计算字段。计算字段并不实际存储在数据库表中，而是在运行时于&lt;code&gt;select&lt;/code&gt;语句中创建的。&lt;/p&gt;
&lt;p&gt;　　实际上，在SQL语句中完成的许多转换和格式化工作都可以在客户机上许多应用软件来完成，但是一般来说在数据库服务器上完成这些操作要比在客户机中更快（因为DBMS是设计来快速有效完成这种处理的）。&lt;br&gt;
    
    </summary>
    
      <category term="Mysql" scheme="http://prophetjeff.com/categories/Mysql/"/>
    
    
      <category term="Mysql" scheme="http://prophetjeff.com/tags/Mysql/"/>
    
  </entry>
  
  <entry>
    <title>Mysql学习笔记（四）——数据过滤</title>
    <link href="http://prophetjeff.com/2017/11/16/mysql-4/"/>
    <id>http://prophetjeff.com/2017/11/16/mysql-4/</id>
    <published>2017-11-16T01:52:03.000Z</published>
    <updated>2017-11-16T11:59:39.411Z</updated>
    
    <content type="html"><![CDATA[<p>　　数据库表包含了大量的数据，通常我们并不期望检索表中的所有行。正如在上一章节中采用<code>limit</code>子句实现结果限定一样，更一般地，我们希望准确检索到表中的特定数据（即表中数据的子集）。这需要在<code>select</code>语句检索中指定搜索条件来完成，搜索条件也称为过滤条件。本章节通过介绍<code>select</code>语句中的<code>where</code>子句，通配符以及正则表达式来实现数据过滤。<br><a id="more"></a></p><h2 id="1-使用WHERE子句过滤数据"><a href="#1-使用WHERE子句过滤数据" class="headerlink" title="1. 使用WHERE子句过滤数据"></a>1. 使用WHERE子句过滤数据</h2><p>　　在<code>select</code>语句中，数据根据<code>where</code>子句中指定的搜索条件进行过滤。注意使用多个子句时的次序，如果出现<code>order by</code>子句，那么<code>where</code>子句需要使用在前者之前，否则将会报错。</p><h3 id="1-1-WHERE子句条件操作符"><a href="#1-1-WHERE子句条件操作符" class="headerlink" title="1.1 WHERE子句条件操作符"></a>1.1 WHERE子句条件操作符</h3><p>　　首先来看一个例子：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_name, prod_price            #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">where</span> prod_price = <span class="number">2.5</span>;</div><div class="line">+<span class="comment">---------------+------------+          #输出</span></div><div class="line">| prod_name     | prod_price |</div><div class="line">+<span class="comment">---------------+------------+</span></div><div class="line">| Carrots       |       2.50 |</div><div class="line">| TNT (1 stick) |       2.50 |</div><div class="line">+<span class="comment">---------------+------------+</span></div><div class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</div></pre></td></tr></table></figure><p>上述语句表示从products表中检索两个列，但不返回其所有行而是返回prod_price等于2.5的行。这个例子采用简单的相等搜索条件，它检查一个列是否具有指定的值，并据此进行过滤，但是SQL能够实现不只如此。下面列出了更多WHERE子句操作符：</p><table><thead><tr><th style="text-align:center">操作符</th><th style="text-align:center">说明</th><th style="text-align:center">操作符</th><th style="text-align:center">说明</th></tr></thead><tbody><tr><td style="text-align:center">=</td><td style="text-align:center">等于</td><td style="text-align:center">&lt;&gt;</td><td style="text-align:center">不等于</td></tr><tr><td style="text-align:center">&lt;</td><td style="text-align:center">小于</td><td style="text-align:center">!=</td><td style="text-align:center">不等于</td></tr><tr><td style="text-align:center">&gt;</td><td style="text-align:center">大于</td><td style="text-align:center">&lt;=</td><td style="text-align:center">小于等于</td></tr><tr><td style="text-align:center">&gt;=</td><td style="text-align:center">大于等于</td><td style="text-align:center">between</td><td style="text-align:center">在指定两个值之间</td></tr></tbody></table><p>注意，需要使用单引号来限定字符串，如果将值与串类型的列进行比较则需要限定引号，而与数值比较时不需要。下例使用了BETWEEN操作符，其语法与其他WHERE子句操作符略有不同，它需要提供两个值（即范围的起始值和结束值）并使用<code>and</code>关键连接，BETWEEN则匹配该范围中的所有值包括端点值。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_name, prod_price              #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">where</span> prod_price <span class="keyword">between</span> <span class="number">5</span> <span class="keyword">and</span> <span class="number">10</span>;</div><div class="line">+<span class="comment">----------------+------------+           #输出</span></div><div class="line">| prod_name      | prod_price |</div><div class="line">+<span class="comment">----------------+------------+</span></div><div class="line">| .5 ton anvil   |       5.99 |</div><div class="line">| 1 ton anvil    |       9.99 |</div><div class="line">| Bird seed      |      10.00 |</div><div class="line">| Oil can        |       8.99 |</div><div class="line">| TNT (5 sticks) |      10.00 |</div><div class="line">+<span class="comment">----------------+------------+</span></div><div class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</div></pre></td></tr></table></figure><h3 id="如何进行空值检查？"><a href="#如何进行空值检查？" class="headerlink" title="如何进行空值检查？"></a>如何进行空值检查？</h3><p>　　在创建表时，设计人员可以指定其中的列是否可以不包含值。一个列不包含值时，称其为包含空值NULL。要注意，空值与字段包含0、空字符串、空格不同。<code>select</code>语句中有一条特殊的<code>where</code>子句，可以实现检索具有空值的列，如下例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_name                 #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">where</span> prod_price <span class="keyword">is</span> <span class="literal">null</span>;</div><div class="line">Empty <span class="keyword">set</span> (<span class="number">0.00</span> sec)             #输出</div></pre></td></tr></table></figure><p>这条语句返回没有价格（空prod_price字段，非价格为0）的所有产品，由于表中没有这样的行，所以没有返回数据。注意，在通过筛选不具有特定值（&lt;&gt;条件操作符）的行时，可能希望返回具有NULL值的行，但是实际上未知是有特定含义的，数据库不知道它们是否匹配所以不会返回NULL值，需要进行进一步验证。</p><h3 id="组合WHERE子句"><a href="#组合WHERE子句" class="headerlink" title="组合WHERE子句"></a>组合WHERE子句</h3><p>　　上述介绍的所有<code>where</code>子句在过滤数据时使用的都是单一的条件，实际中往往需要通过多个<code>where</code>子句建立更强更高级的搜索条件。Mysql可以通过<code>and</code>和<code>or</code>操作符连接多条<code>where</code>子句。如下例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_id, prod_price, prod_name              #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">where</span> vend_id = <span class="number">1003</span> <span class="keyword">and</span> prod_price &lt;= <span class="number">10</span>;</div><div class="line">+<span class="comment">---------+------------+----------------+          #输出</span></div><div class="line">| prod_id | prod_price | prod_name      |</div><div class="line">+<span class="comment">---------+------------+----------------+</span></div><div class="line">| FB      |      10.00 | Bird seed      |</div><div class="line">| FC      |       2.50 | Carrots        |</div><div class="line">| SLING   |       4.49 | Sling          |</div><div class="line">| TNT1    |       2.50 | TNT (1 stick)  |</div><div class="line">| TNT2    |      10.00 | TNT (5 sticks) |</div><div class="line">+<span class="comment">---------+------------+----------------+</span></div><div class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p>上述语句检索供应商ID为1003且价格小于等于10美元的所有产品，<code>and</code>关键字用在<code>where</code>子句中可检索同时满足给定条件的行。当然，可以将更多过滤条件组合在一起，但每添加一条就需要再加一个关键字。</p><p>　　类似地，<code>or</code>操作符用在<code>where</code>子句中可检索满足任一给定条件的行。需要特别注意的是，<code>where</code>子句可包含任意数目的<code>and</code>和<code>or</code>操作符，两者结合可以实现更复杂的检索。但组合<code>and</code>和<code>or</code>会面临一个问题——处理次序。SQL在处理<code>or</code>操作符前会优先处理<code>and</code>操作符，即<code>and</code>的优先级更高。为了避免出现歧义和错误，可以使用圆括号对操作符进行明确的分组，而不应该过分依赖默认次序。</p><h3 id="WHERE子句中的IN操作符和NOT操作符"><a href="#WHERE子句中的IN操作符和NOT操作符" class="headerlink" title="WHERE子句中的IN操作符和NOT操作符"></a>WHERE子句中的IN操作符和NOT操作符</h3><ul><li><code>in</code>：<code>in</code>操作符用来指定条件范围，范围中的每个条件都可以进行匹配。</li><li><code>not</code>：<code>not</code>操作符是用来否定后跟条件的关键字。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_name, prod_price            #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">where</span> vend_id <span class="keyword">not</span> <span class="keyword">in</span> (<span class="number">1002</span>,<span class="number">1003</span>)</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> prod_name;</div><div class="line">+<span class="comment">--------------+------------+           #输出</span></div><div class="line">| prod_name    | prod_price |</div><div class="line">+<span class="comment">--------------+------------+</span></div><div class="line">| .5 ton anvil |       5.99 |</div><div class="line">| 1 ton anvil  |       9.99 |</div><div class="line">| 2 ton anvil  |      14.99 |</div><div class="line">| JetPack 1000 |      35.00 |</div><div class="line">| JetPack 2000 |      55.00 |</div><div class="line">+<span class="comment">--------------+------------+</span></div><div class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p>要注意，此处的<code>(1002,1003)</code>并非代表一个区间，而是包含1002及1003这两个元素的集合。区间的表示是使用<code>between</code>操作符。</p><p>　　上例语句检索了非1002及1003供应商的所有产品及其价格，并按照产品名进行排序。可以看出，<code>in</code>操作符的功能与<code>or</code>功能非常相似，实际上，在使用多个过滤条件时<code>in</code>操作符更加清楚直观执行更快（因为它使用的操作符更少）。<code>in</code>操作符的最大优点在于它可以包含其他<code>select</code>语句（子查询），在后续的章节中会对它进行介绍。同样地，<code>not</code>关键字可以简化更加复杂的多个过滤条件，提高效率。</p><h2 id="2-使用通配符进行过滤"><a href="#2-使用通配符进行过滤" class="headerlink" title="2. 使用通配符进行过滤"></a>2. 使用通配符进行过滤</h2><p>　　前文介绍的所有操作符都是针对已知值进行过滤的，但有的时候我们对自己要检索的数据了解得并不是那么全面或者说清楚。比如，如何检索在产品名中包含文本“jet”的所有产品？显然，前文提供的方法都行不通，因为我们不清楚自己要检索的产品名称具体是什么，这时，我们需要使用通配符创建特定的搜索模式。</p><p>　　在搜索子句中要使用通配符，必须使用<code>like</code>操作符。<code>like</code>指示Mysql后跟的搜索模式利用通配符匹配，而不是直接相等匹配进行比较。</p><ul><li><strong>通配符</strong>（wildcard）：用来匹配值的一部分的特殊字符。</li><li><strong>搜索模式</strong>（search pattern）：由字面值、通配符或两者组合构成的搜索条件。</li><li><strong>谓词</strong>（predicate）：操作符何时不是操作符？答案是在它作为谓词时。（从技术上说，<code>like</code>是谓词而不是操作符，虽然最终的结果是相同的，但需要对此术语进行了解，以免在SQL文档中遇到此术语时不知道）。</li></ul><h3 id="2-1-百分号（-）通配符"><a href="#2-1-百分号（-）通配符" class="headerlink" title="2.1 百分号（%）通配符"></a>2.1 百分号（%）通配符</h3><p>　　最常使用的通配符是百分号（%）。在搜索中，%表示任何字符出现任意次数。例如，为了找出所有产品名以“jet”起始的产品，可以使用如下<code>select</code>语句：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_id, prod_name              #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">where</span> prod_name <span class="keyword">like</span> <span class="string">'jet%'</span>;</div><div class="line">+<span class="comment">---------+--------------+             #输出</span></div><div class="line">| prod_id | prod_name    |</div><div class="line">+<span class="comment">---------+--------------+</span></div><div class="line">| JP1000  | JetPack 1000 |</div><div class="line">| JP2000  | JetPack 2000 |</div><div class="line">+<span class="comment">---------+--------------+</span></div><div class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p>此例使用的搜索模式为’jet%’，在执行这条子句时将检索任意以“jet”起头的词。<code>%</code>告诉Mysql接受“jet”之后的任意字符。注意，通配符可以在搜索模式中任意位置中使用，并且可以使用多个通配符。如下例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_id, prod_name          #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">where</span> prod_name <span class="keyword">like</span> <span class="string">'%anvil%'</span>     #表示匹配任何位置包含文本anvil的值</div></pre></td></tr></table></figure><p>注意，<code>%</code>代表搜索模式中给定位置的0个，1个或多个字符（NULL除外，即<code>like &#39;%&#39;</code>也不能匹配NULL值，而空格不是空值是字符不要疏忽）。</p><h3 id="2-2-下划线（-）通配符"><a href="#2-2-下划线（-）通配符" class="headerlink" title="2.2 下划线（_）通配符"></a>2.2 下划线（_）通配符</h3><p>　　下划线通配符与百分号通配符用途基本一致，但是下划线只匹配单个字符而不是多个。如下例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_id, prod_name                 #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">where</span> prod_name <span class="keyword">like</span> <span class="string">'_ ton anvil'</span>;</div><div class="line">+<span class="comment">---------+-------------+                 #输出</span></div><div class="line">| prod_id | prod_name   |</div><div class="line">+<span class="comment">---------+-------------+</span></div><div class="line">| ANV02   | 1 ton anvil |</div><div class="line">| ANV03   | 2 ton anvil |</div><div class="line">+<span class="comment">---------+-------------+</span></div><div class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p>　　正如上述，Mysql通配符功能强大，但是这种共也是有代价的，使用通配符的检索处理往往比其他检索花的时间更长。因此，不要过度使用通配符（如果其他操作符能达到相同目的尽量使用其他操作符）。除非绝对必要，尽量不要讲通配符置于开始处，这样检索起来是最慢的。其次，要特别注意通配符的位置，如果位置错误可能不会返回你想要的数据。</p><h2 id="3-使用正则表达式进行检索"><a href="#3-使用正则表达式进行检索" class="headerlink" title="3. 使用正则表达式进行检索"></a>3. 使用正则表达式进行检索</h2><p>　　对于基本的检索和过滤，前文使用的匹配、比较和通配符基本可以实现。但如果过滤条件更加复杂，比如从文本块中提取电话号码，找到重复单词等等目标，仅仅采用前文方法就不足以实现。正则表达式是通过正则表达式语言来建立，可以完成上述及更广泛目标（匹配文本）的特殊语言。Mysql用<code>where</code>子句对正则表达式提供了初步支持（Mysql仅支持多数正则表达式实现的一个很小的子集），允许指定正则表达式来过滤<code>select</code>语句检索出的数据。</p><h3 id="3-1-基本字符匹配"><a href="#3-1-基本字符匹配" class="headerlink" title="3.1 基本字符匹配"></a>3.1 基本字符匹配</h3><p>　　首先来看下面这个例子：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_name                    #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">where</span> prod_name regexp <span class="string">'.000'</span></div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> prod_name;</div><div class="line">+<span class="comment">--------------+                    #输出</span></div><div class="line">| prod_name    |</div><div class="line">+<span class="comment">--------------+</span></div><div class="line">| JetPack 1000 |</div><div class="line">| JetPack 2000 |</div><div class="line">+<span class="comment">--------------+</span></div><div class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p>这里使用了正则表达式<code>&#39;.000&#39;</code>。其中<code>.</code>是正则表达式语言中的一个特殊字符，它表示匹配任意一个字符。<code>regexp</code>关键字告诉Mysql后跟的东西作为正则表达式处理。当然，这个特殊的例子也可以通过<code>like</code>关键字和通配符来完成。注意，<code>like</code>和<code>regexp</code>的区别，<code>like</code>匹配整个列（如果不使用通配符来帮助的话），而<code>regexp</code>在列值内进行匹配。Mysql中的正则表达式不区分大小写，若要区分可使用<code>binary</code>关键字，如<code>where prod_name regexp binary &#39;JetPack .000&#39;</code>。</p><h3 id="3-2-进行OR匹配"><a href="#3-2-进行OR匹配" class="headerlink" title="3.2 进行OR匹配"></a>3.2 进行OR匹配</h3><p>　　见下面这个例子：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_name                             #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">where</span> prod_name regexp <span class="string">'1000|2000|3000'</span></div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> prod_name;</div><div class="line">+<span class="comment">--------------+                             #输出</span></div><div class="line">| prod_name    |</div><div class="line">+<span class="comment">--------------+</span></div><div class="line">| JetPack 1000 |</div><div class="line">| JetPack 2000 |</div><div class="line">+<span class="comment">--------------+</span></div><div class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p><code>|</code>是正则表达式中的OR操作符，它表示匹配其中之一。</p><h3 id="3-3-匹配几个字符之一"><a href="#3-3-匹配几个字符之一" class="headerlink" title="3.3 匹配几个字符之一"></a>3.3 匹配几个字符之一</h3><p>　　要匹配特定的字符，可以使用一组被<code>[</code>和<code>]</code>括起来 字符来完成。如下例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_name                              #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">where</span> prod_name regexp <span class="string">'[123] ton'</span></div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> prod_name;</div><div class="line">+<span class="comment">-------------+                               #输出</span></div><div class="line">| prod_name   |</div><div class="line">+<span class="comment">-------------+</span></div><div class="line">| 1 ton anvil |</div><div class="line">| 2 ton anvil |</div><div class="line">+<span class="comment">-------------+</span></div><div class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p>这里，<code>[123]</code>定义一组字符，它的意思是匹配1或2或3。正如所见，<code>[]</code>是另一种形式的OR语句，它是<code>[1|2|3] ton</code>的缩写，也可以使用后者。至于为和需要用<code>[]</code>来定义OR语句要查找什么，各位可以自己试一试去掉<code>[]</code>会发生什么。注意，字符集合也可以被否定（即，它们将匹配除指定字符外的任何东西，这一目的通过在<code>[]</code>内开始处放置一个<code>^</code>来完成，如<code>[^123]</code>）。</p><h3 id="3-4-匹配范围"><a href="#3-4-匹配范围" class="headerlink" title="3.4 匹配范围"></a>3.4 匹配范围</h3><p>　　集合可以用来定义要匹配的一个或多个字符，比如<code>[123456789]</code>。但显然，当字符元素过多时，使用这种表达将会变得麻烦而且容易出错。可以使用<code>-</code>来定义一个范围，达到简化集合的作用，如下例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_name                              #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">where</span> prod_name regexp <span class="string">'[1-3] ton'</span></div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> prod_name;</div><div class="line">+<span class="comment">-------------+                               #输出</span></div><div class="line">| prod_name   |</div><div class="line">+<span class="comment">-------------+</span></div><div class="line">| 1 ton anvil |</div><div class="line">| 2 ton anvil |</div><div class="line">+<span class="comment">-------------+</span></div><div class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p>注意，范围不一定只可以是数值的，比如<code>[a-z]</code>匹配任意字母字符。</p><h3 id="3-5-匹配特殊字符"><a href="#3-5-匹配特殊字符" class="headerlink" title="3.5 匹配特殊字符"></a>3.5 匹配特殊字符</h3><p>　　此处所说的特殊字符是正则表示语言中使用过的字符，比如要匹配文本中的“.”，而<code>.</code>在正则表达式中有特殊含义，因此此处需要使用转义（由<code>\\</code>来引导），如下例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> vend_name                             #输入</div><div class="line"><span class="keyword">from</span> vendors</div><div class="line"><span class="keyword">where</span> vend_name regexp <span class="string">'\\.'</span></div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> vend_name;</div><div class="line">+<span class="comment">--------------+                             #输出</span></div><div class="line">| vend_name    |</div><div class="line">+<span class="comment">--------------+</span></div><div class="line">| Furball Inc. |</div><div class="line">+<span class="comment">--------------+</span></div><div class="line">1 row in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</div></pre></td></tr></table></figure><h3 id="3-6-匹配字符类"><a href="#3-6-匹配字符类" class="headerlink" title="3.6 匹配字符类"></a>3.6 匹配字符类</h3><p>　　实际中会遇到检索自己常使用的数字、所有字母字符或所有数字字母字符等的匹配。为了方便起见，可以使用预定的字符集，称为字符类（character class）。见下表：</p><table><thead><tr><th style="text-align:center">类</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:center">[:alnum:]</td><td style="text-align:left">任意数字和字母（同<code>[a-zA-Z0-9]</code>）</td></tr><tr><td style="text-align:center">[:alpha:]</td><td style="text-align:left">任意字符（同<code>[a-zA-Z]</code>）</td></tr><tr><td style="text-align:center">[:blank:]</td><td style="text-align:left">空格和制表（同<code>[\\t]</code>）</td></tr><tr><td style="text-align:center">[:cntrl:]</td><td style="text-align:left">ASCII控制字符（ASCII0到31和127）</td></tr><tr><td style="text-align:center">[:digit:]</td><td style="text-align:left">任意数字（同<code>[0-9]</code>）</td></tr><tr><td style="text-align:center">[:graph:]</td><td style="text-align:left">与[:print:]相同但不包括空格</td></tr><tr><td style="text-align:center">[:lower:]</td><td style="text-align:left">任意小写字母（同<code>[a-z]</code>）</td></tr><tr><td style="text-align:center">[:print:]</td><td style="text-align:left">任意可打印字符</td></tr><tr><td style="text-align:center">[:punct:]</td><td style="text-align:left">既不在[:alnum:]又不在[:cntrl:]中的任意字符</td></tr><tr><td style="text-align:center">[:space:]</td><td style="text-align:left">包括空格在内的任意空白字符（同<code>[\\f\\n\\r\\t\\v]</code>）</td></tr><tr><td style="text-align:center">[:upper:]</td><td style="text-align:left">任意大写字母（同<code>[A-Z]</code>）</td></tr><tr><td style="text-align:center">[:xdigit:]</td><td style="text-align:left">任意十六进制数字（同<code>[a-fA-F0-9]</code>）</td></tr></tbody></table><h3 id="3-7-匹配多个实例"><a href="#3-7-匹配多个实例" class="headerlink" title="3.7 匹配多个实例"></a>3.7 匹配多个实例</h3><p>　　目前使用的所用正则表达式都试图匹配单词出现，有时候，需要的检索对匹配的数目控制更强。例如，想要搜寻所有的数，不管包含都少个数字，或者寻找一个单词且还能够适应一个尾随的s（如果存在）等等。这可以通过正则表达式的重复元字符来完成。下面是正则表达式重复元字符表:</p><table><thead><tr><th style="text-align:center">元字符</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:center">*</td><td style="text-align:left">0个或多个匹配</td></tr><tr><td style="text-align:center">+</td><td style="text-align:left">1个或多个匹配</td></tr><tr><td style="text-align:center">?</td><td style="text-align:left">0个或1个匹配</td></tr><tr><td style="text-align:center">{n}</td><td style="text-align:left">指定数目的匹配</td></tr><tr><td style="text-align:center">{n,}</td><td style="text-align:left">不少于指定数目的匹配</td></tr><tr><td style="text-align:center">{n,m}</td><td style="text-align:left">匹配数目的范围（m不超过225）</td></tr></tbody></table><p>下面是一个使用重复元字符的例子：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_name                                    #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">where</span> prod_name regexp <span class="string">'\\([0-9] sticks?\\)'</span>        #？使其前一个字母s可选</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> prod_name;</div><div class="line">+<span class="comment">----------------+                                  #输出</span></div><div class="line">| prod_name      |</div><div class="line">+<span class="comment">----------------+</span></div><div class="line">| TNT (1 stick)  |</div><div class="line">| TNT (5 sticks) |</div><div class="line">+<span class="comment">----------------+</span></div><div class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><h3 id="3-8-定位符"><a href="#3-8-定位符" class="headerlink" title="3.8 定位符"></a>3.8 定位符</h3><p>　　前述所有例子都是匹配一个串中任意位置的文本，想要匹配特定位置的文本需要使用下表列出的定位符：</p><table><thead><tr><th style="text-align:center">定位元字符</th><th style="text-align:center">说明</th></tr></thead><tbody><tr><td style="text-align:center">^</td><td style="text-align:center">文本的开始</td></tr><tr><td style="text-align:center">$</td><td style="text-align:center">文本的结尾</td></tr><tr><td style="text-align:center">[[:&lt;:]]</td><td style="text-align:center">词的开始</td></tr><tr><td style="text-align:center">[[:&gt;:]]</td><td style="text-align:center">词的结尾</td></tr></tbody></table><p>　　例如，若想找出一个数（包括以一个小数点开始的数）开头的所有产品名：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_name                                     #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">where</span> prod_name regexp <span class="string">'^[0-9\\.]'</span></div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> prod_name;</div><div class="line">+<span class="comment">--------------+                                     #输出</span></div><div class="line">| prod_name    |</div><div class="line">+<span class="comment">--------------+</span></div><div class="line">| .5 ton anvil |</div><div class="line">| 1 ton anvil  |</div><div class="line">| 2 ton anvil  |</div><div class="line">+<span class="comment">--------------+</span></div><div class="line">3 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p>注意，<code>^</code>有双重用途，在集合中（由<code>[</code>和<code>]</code>定义）它用于否定该集合；否则，它用来指串的开始处。</p><h3 id="如何测试正则表达式？"><a href="#如何测试正则表达式？" class="headerlink" title="如何测试正则表达式？"></a>如何测试正则表达式？</h3><p>　　实际中可以在不使用数据库表的情况下用<code>select</code>来测试正则表达式，此时，<code>regexp</code>总是返回0（没有匹配）或1（匹配）。例如<code>select &#39;hello&#39; regexp &#39;[0-9]&#39;;</code>，这个例子返回的结果是0。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;　　数据库表包含了大量的数据，通常我们并不期望检索表中的所有行。正如在上一章节中采用&lt;code&gt;limit&lt;/code&gt;子句实现结果限定一样，更一般地，我们希望准确检索到表中的特定数据（即表中数据的子集）。这需要在&lt;code&gt;select&lt;/code&gt;语句检索中指定搜索条件来完成，搜索条件也称为过滤条件。本章节通过介绍&lt;code&gt;select&lt;/code&gt;语句中的&lt;code&gt;where&lt;/code&gt;子句，通配符以及正则表达式来实现数据过滤。&lt;br&gt;
    
    </summary>
    
      <category term="Mysql" scheme="http://prophetjeff.com/categories/Mysql/"/>
    
    
      <category term="Mysql" scheme="http://prophetjeff.com/tags/Mysql/"/>
    
      <category term="通配符" scheme="http://prophetjeff.com/tags/%E9%80%9A%E9%85%8D%E7%AC%A6/"/>
    
      <category term="正则表达式" scheme="http://prophetjeff.com/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>Mysql学习笔记（三）——数据检索与排序</title>
    <link href="http://prophetjeff.com/2017/11/15/mysql-3/"/>
    <id>http://prophetjeff.com/2017/11/15/mysql-3/</id>
    <published>2017-11-15T07:10:00.000Z</published>
    <updated>2017-11-15T07:27:53.884Z</updated>
    
    <content type="html"><![CDATA[<p>　　本节介绍数据的检索与排序，此操作将由<code>select</code>语句及其子句<code>order by</code>分别实现。要知道，SQL语句是由简单的英语单词构成，如<code>select</code>，<code>create</code>这些单词在SQL语言中被称为关键字。接触过SQL语言的小伙伴应该知道<code>select</code>基本算是最常使用的SQL关键字了，它几乎就是SQL的象征，下面是<code>select</code>的表演时间。<br><a id="more"></a></p><h2 id="1-检索数据"><a href="#1-检索数据" class="headerlink" title="1. 检索数据"></a>1. 检索数据</h2><p>　　首先，<code>select</code>语句的用途是从一个或多个表中检索信息，而要使用其来检索表数据至少需要给出两条信息：一是想检索的是什么，二是从什么地方进行检索（比如你要检索的信息来自哪张表）。</p><h4 id="1-1-检索单个列"><a href="#1-1-检索单个列" class="headerlink" title="1.1 检索单个列"></a>1.1 检索单个列</h4><p>　　比如，想从产品表（products）中检索产品名对应的列（prod_name）,需要<code>select</code>语句后接列名，并使用<code>from</code>关键字指出存放该数据的表。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_name     #输入</div><div class="line"><span class="keyword">from</span> products;    </div><div class="line">+<span class="comment">----------------+   #输出</span></div><div class="line">| prod_name      |</div><div class="line">+<span class="comment">----------------+</span></div><div class="line">| .5 ton anvil   |</div><div class="line">| 1 ton anvil    |</div><div class="line">| 2 ton anvil    |</div><div class="line">| Detonator      |</div><div class="line">| Bird seed      |</div><div class="line">| Carrots        |</div><div class="line">| Fuses          |</div><div class="line">| JetPack 1000   |</div><div class="line">| JetPack 2000   |</div><div class="line">| Oil can        |</div><div class="line">| Safe           |</div><div class="line">| Sling          |</div><div class="line">| TNT (1 stick)  |</div><div class="line">| TNT (5 sticks) |</div><div class="line">+<span class="comment">----------------+</span></div><div class="line">14 rows in <span class="keyword">set</span> (<span class="number">0.05</span> sec)</div></pre></td></tr></table></figure><p>上述<code>select</code>语句返回products表中prod_name这一列的所有行，且没有经过排序（也就是说重复上述语句输出的结果顺序可能不一致，要知道没有经过排序而考察顺序是毫无意义的，只要行数一致就是正常的）。</p><p>　　注意，SQL关键字不区分大小写。在处理SQL语句时其中的空格都将被忽略，即SQL语句可以在一行给出也可以进行分行（分行会使语句更容易阅读和调试）。多条语句间必须使用<code>;</code>加以分割，在多数的DBMS中，单条语句后<code>;</code>可加可不加，但是如果使用的是mysql命令行实用程序，必须加上<code>;</code>来结束SQL语句。</p><h4 id="1-2-检索多个列"><a href="#1-2-检索多个列" class="headerlink" title="1.2 检索多个列"></a>1.2 检索多个列</h4><p>　　如果想要从一张表上检索多个列，也采用与上述相同的<code>select</code>语句，但<code>select</code>关键字后需要给出多个列名且列名之间用逗号分隔。比如，想要从产品表（products）中检索产品号（prod_id），产品名（prod_name），产品价格（prod_price）信息。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_id, prod_name, prod_price       #输入</div><div class="line"><span class="keyword">from</span> products;</div><div class="line">+<span class="comment">---------+----------------+------------+   #输出</span></div><div class="line">| prod_id | prod_name      | prod_price |</div><div class="line">+<span class="comment">---------+----------------+------------+</span></div><div class="line">| ANV01   | .5 ton anvil   |       5.99 |</div><div class="line">| ANV02   | 1 ton anvil    |       9.99 |</div><div class="line">| ANV03   | 2 ton anvil    |      14.99 |</div><div class="line">| DTNTR   | Detonator      |      13.00 |</div><div class="line">| FB      | Bird seed      |      10.00 |</div><div class="line">| FC      | Carrots        |       2.50 |</div><div class="line">| FU1     | Fuses          |       3.42 |</div><div class="line">| JP1000  | JetPack 1000   |      35.00 |</div><div class="line">| JP2000  | JetPack 2000   |      55.00 |</div><div class="line">| OL1     | Oil can        |       8.99 |</div><div class="line">| SAFE    | Safe           |      50.00 |</div><div class="line">| SLING   | Sling          |       4.49 |</div><div class="line">| TNT1    | TNT (1 stick)  |       2.50 |</div><div class="line">| TNT2    | TNT (5 sticks) |      10.00 |</div><div class="line">+<span class="comment">---------+----------------+------------+</span></div><div class="line">14 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p>注意，SQL语句一般返回原始、无格式的数据。数据展现的格式是一个表示问题，而不应包括在数据的检索中。</p><h4 id="1-3-检索所有列"><a href="#1-3-检索所有列" class="headerlink" title="1.3 检索所有列"></a>1.3 检索所有列</h4><p>　　要检索出一张表的所有列，同样使用上述相同的<code>select</code>语句，但不需要逐个列出表中的所有列。这可以采用<code>*</code>通配符来实现，事实上<code>*</code>通配符的好处在于你或许不知道所有列的列名，而通过它能检索出未知列。其语句如下：</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">select * from products;    #输入</div></pre></td></tr></table></figure><h4 id="如何实现检索不同的行？"><a href="#如何实现检索不同的行？" class="headerlink" title="如何实现检索不同的行？"></a>如何实现检索不同的行？</h4><p>　　如上述，<code>select</code>语句的结果返回被检索列的所有行，比如检索产品表（products）中供应商ID（vend_id）这一列，返回结果：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">select vend_id from products;   #输入</div><div class="line">+<span class="comment">---------+                     #输出 </span></div><div class="line">| vend_id |</div><div class="line">+<span class="comment">---------+</span></div><div class="line">|    1001 |</div><div class="line">|    1001 |</div><div class="line">|    1001 |</div><div class="line">|    1002 |</div><div class="line">|    1002 |</div><div class="line">|    1003 |</div><div class="line">|    1003 |</div><div class="line">|    1003 |</div><div class="line">|    1003 |</div><div class="line">|    1003 |</div><div class="line">|    1003 |</div><div class="line">|    1003 |</div><div class="line">|    1005 |</div><div class="line">|    1005 |</div><div class="line">+<span class="comment">---------+</span></div><div class="line">14 rows in <span class="keyword">set</span> (<span class="number">0.02</span> sec)</div></pre></td></tr></table></figure><p>虽然结果显示返回14行（因为products表中列出了14个产品），但是容易看到实际表中只有4个供应商，想要只返回列中的不同值需要用到<code>distinct</code>关键字，它指示Mysql只返回不同值。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> vend_id     #输入</div><div class="line"><span class="keyword">from</span> products;</div><div class="line">+<span class="comment">---------+                 #输出 </span></div><div class="line">| vend_id |</div><div class="line">+<span class="comment">---------+</span></div><div class="line">|    1001 |</div><div class="line">|    1002 |</div><div class="line">|    1003 |</div><div class="line">|    1005 |</div><div class="line">+<span class="comment">---------+</span></div><div class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.05</span> sec)</div></pre></td></tr></table></figure><p>注意，<code>distinct</code>关键字应用于给出的所有列儿不仅仅只是前置它的列。</p><h4 id="如何限制输出？"><a href="#如何限制输出？" class="headerlink" title="如何限制输出？"></a>如何限制输出？</h4><p>　　或许在有些情况下，你只希望查看某一列的前几行，在<code>select</code>语句中家加入<code>limit</code>子句可以实现这一任务。下面给出两个例子：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_name <span class="keyword">from</span> products  #输入</div><div class="line"><span class="keyword">limit</span> <span class="number">5</span>;</div><div class="line">+<span class="comment">--------------+                #输出 </span></div><div class="line">| prod_name    |</div><div class="line">+<span class="comment">--------------+</span></div><div class="line">| .5 ton anvil |</div><div class="line">| 1 ton anvil  |</div><div class="line">| 2 ton anvil  |</div><div class="line">| Detonator    |</div><div class="line">| Bird seed    |</div><div class="line">+<span class="comment">--------------+</span></div><div class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p>上述语句中，<code>limit 5</code>指示Mysql返回前5行。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_name <span class="keyword">from</span> products  #输入</div><div class="line"><span class="keyword">limit</span> <span class="number">5</span>, <span class="number">5</span>;</div><div class="line">+<span class="comment">--------------+                #输出</span></div><div class="line">| prod_name    |</div><div class="line">+<span class="comment">--------------+</span></div><div class="line">| Carrots      |</div><div class="line">| Fuses        |</div><div class="line">| JetPack 1000 |</div><div class="line">| JetPack 2000 |</div><div class="line">| Oil can      |</div><div class="line">+<span class="comment">--------------+</span></div><div class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p>上述语句可以得到下一个5行，<code>limit 5, 5</code>指示Mysql返回从行5开始的5行，其中第一个数表示开始位置，第二个数表示要检索的行数。注意此处的第一个参数为行的索引号而不是真实的行序号，实际上行的索引号比行序号要小1，即第1行为行0而不是行1。且要注意带一个值的<code>limit</code>总是从第一行开始，给出的数为返回的行数；而带两个值的<code>limit</code>是从第一个值的位置开始返回行，返回行数为第二个值。<code>limit</code>语句还有一种替代语法，例如<code>limit 5 offset 2</code>，它等同于<code>limit 2, 5</code>。</p><h2 id="2-排序检索数据"><a href="#2-排序检索数据" class="headerlink" title="2. 排序检索数据"></a>2. 排序检索数据</h2><p>　　在前一部分的数据检索中使用的<code>select</code>语句输出中可以看到，返回结果是没有特定顺序的。实际上，以此方式检索出的数据并非以纯粹的随机顺序显示。如果不进行排序，数据一般讲以它在底层表中出现的顺序显示，这可能是数据最开始添加到表中的顺序。但是，如果数据后来进行过更新或者删除，则此顺序会受到Mysql重用回收存储空间的影响，也就是说在没有明确控制顺序的情况下此输出结果的顺序是没有参考价值的。</p><ul><li><strong>子句</strong>（clause）： 一个子句通常由一个关键字和所提供的数据组成。一条完整的SQL语句可包含子句，有些子句是必须的（比如<code>select</code>语句中的<code>from</code>子句，通过它确定需要提取列所在的表），而有些子句是可选的。</li></ul><h4 id="2-1-排序数据"><a href="#2-1-排序数据" class="headerlink" title="2.1 排序数据"></a>2.1 排序数据</h4><p>　　为了对<code>select</code>语句检索出的数据进行排序，可以使用<code>order by</code>子句确定一个或多个列名，并据此对输出进行排序。注意，通常<code>order by</code>子句中所使用的列是<code>select</code>语句中选择的列，但也可以不是（即使用其他列对<code>select</code>语句中的列进行排序也是可以的）。下面是数据排序的一个例子：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_id, prod_price, prod_name          #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> prod_price, prod_name</div><div class="line">+<span class="comment">---------+------------+----------------+      #输出</span></div><div class="line">| prod_id | prod_price | prod_name      |</div><div class="line">+<span class="comment">---------+------------+----------------+</span></div><div class="line">| FC      |       <span class="number">2.50</span> | Carrots        |</div><div class="line">| TNT1    |       <span class="number">2.50</span> | TNT (<span class="number">1</span> stick)  |</div><div class="line">| FU1     |       <span class="number">3.42</span> | Fuses          |</div><div class="line">| SLING   |       <span class="number">4.49</span> | Sling          |</div><div class="line">| ANV01   |       <span class="number">5.99</span> | <span class="number">.5</span> ton anvil   |</div><div class="line">| OL1     |       <span class="number">8.99</span> | Oil can        |</div><div class="line">| ANV02   |       <span class="number">9.99</span> | <span class="number">1</span> ton anvil    |</div><div class="line">| FB      |      <span class="number">10.00</span> | Bird <span class="keyword">seed</span>      |</div><div class="line">| TNT2    |      <span class="number">10.00</span> | TNT (<span class="number">5</span> sticks) |</div><div class="line">| DTNTR   |      <span class="number">13.00</span> | Detonator      |</div><div class="line">| ANV03   |      <span class="number">14.99</span> | <span class="number">2</span> ton anvil    |</div><div class="line">| JP1000  |      <span class="number">35.00</span> | JetPack <span class="number">1000</span>   |</div><div class="line">| <span class="keyword">SAFE</span>    |      <span class="number">50.00</span> | <span class="keyword">Safe</span>           |</div><div class="line">| JP2000  |      <span class="number">55.00</span> | JetPack <span class="number">2000</span>   |</div><div class="line">+<span class="comment">---------+------------+----------------+</span></div><div class="line"><span class="number">14</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p>此例是检索产品表中的产品ID，产品价格和产品名，并对输出结果按照产品价格和产品名进行排序（先按价格排序，再按名称排序）。注意，在按照多个列进行排序时，排序完全按照所规定的顺序进行（在本例中如果多个行具有相同的价格则咱其名称进行再排序）。</p><h4 id="2-2-指定排序的方向"><a href="#2-2-指定排序的方向" class="headerlink" title="2.2 指定排序的方向"></a>2.2 指定排序的方向</h4><p>　　数据排序不限于升序排序（这是默认的排序顺序），还可以通过在<code>order by</code>子句中指定<code>desc</code>关键字对输出结果进行降序排序。如下例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> prod_id, prod_price, prod_name          #输入</div><div class="line"><span class="keyword">from</span> products</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> prod_price <span class="keyword">desc</span>;</div><div class="line">+<span class="comment">---------+------------+----------------+      #输出</span></div><div class="line">| prod_id | prod_price | prod_name      |</div><div class="line">+<span class="comment">---------+------------+----------------+</span></div><div class="line">| JP2000  |      55.00 | JetPack 2000   |</div><div class="line">| SAFE    |      50.00 | Safe           |</div><div class="line">| JP1000  |      35.00 | JetPack 1000   |</div><div class="line">| ANV03   |      14.99 | 2 ton anvil    |</div><div class="line">| DTNTR   |      13.00 | Detonator      |</div><div class="line">| FB      |      10.00 | Bird seed      |</div><div class="line">| TNT2    |      10.00 | TNT (5 sticks) |</div><div class="line">| ANV02   |       9.99 | 1 ton anvil    |</div><div class="line">| OL1     |       8.99 | Oil can        |</div><div class="line">| ANV01   |       5.99 | .5 ton anvil   |</div><div class="line">| SLING   |       4.49 | Sling          |</div><div class="line">| FU1     |       3.42 | Fuses          |</div><div class="line">| FC      |       2.50 | Carrots        |</div><div class="line">| TNT1    |       2.50 | TNT (1 stick)  |</div><div class="line">+<span class="comment">---------+------------+----------------+</span></div><div class="line">14 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p>注意，<code>desc</code>关键字只应用到直接位于其前面的列名，位于其后的列名仍然按默认的升序。如果想在多个列上进行降序排序，需要对<code>order by</code>后的每个列名指定<code>desc</code>关键字。与<code>desc</code>关键字相反的是<code>asc</code>关键字，但升序是默认的排序方式，所以无需特别指定。</p><p>　　其次，要特别注意各个子句出现的次序（比如<code>order by</code>子句出现在<code>from</code>子句之后，而<code>limit</code>子句出现在<code>order by</code>子句之后），子句次序混乱将会报错。</p><h4 id="如何检索一列中最高或者最底的值？"><a href="#如何检索一列中最高或者最底的值？" class="headerlink" title="如何检索一列中最高或者最底的值？"></a>如何检索一列中最高或者最底的值？</h4><p>　　到目前为止<code>order by</code>以及<code>limit</code>子句可以帮助实现这一检索，have a try!</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;　　本节介绍数据的检索与排序，此操作将由&lt;code&gt;select&lt;/code&gt;语句及其子句&lt;code&gt;order by&lt;/code&gt;分别实现。要知道，SQL语句是由简单的英语单词构成，如&lt;code&gt;select&lt;/code&gt;，&lt;code&gt;create&lt;/code&gt;这些单词在SQL语言中被称为关键字。接触过SQL语言的小伙伴应该知道&lt;code&gt;select&lt;/code&gt;基本算是最常使用的SQL关键字了，它几乎就是SQL的象征，下面是&lt;code&gt;select&lt;/code&gt;的表演时间。&lt;br&gt;
    
    </summary>
    
      <category term="Mysql" scheme="http://prophetjeff.com/categories/Mysql/"/>
    
    
      <category term="Mysql" scheme="http://prophetjeff.com/tags/Mysql/"/>
    
  </entry>
  
  <entry>
    <title>Mysql学习笔记（二）——连接服务器</title>
    <link href="http://prophetjeff.com/2017/11/14/mysql-2/"/>
    <id>http://prophetjeff.com/2017/11/14/mysql-2/</id>
    <published>2017-11-14T08:10:00.000Z</published>
    <updated>2017-11-14T10:05:32.567Z</updated>
    
    <content type="html"><![CDATA[<p>　　前一章节介绍了数据库基本概念，在有可使用的服务器和客户机软件之后，连接到数据库是执行后续操作的首要步骤。所有的图形化客户机软件都提供服务器连接窗口，本小白使用的是最原始的Mysql命令行实用程序，后续展现的代码也是基于该客户机工具。<br><a id="more"></a></p><h4 id="服务器连接"><a href="#服务器连接" class="headerlink" title="服务器连接"></a>服务器连接</h4><p>要连接到服务器需要知道其四个基本信息：主机名，端口，用户名以及口令。</p><ul><li><strong>主机名</strong>：也是计算机名，如果连接的是本地Mysql服务器则为localhost。</li><li><strong>端口</strong>：如果使用默认端口3306之外的端口需要提供其端口号。（在网络上，各主机通过TCP/IP协议进行数据交互，而主机上有多程序同时运行，要将数据准确传输到某个特定的程序就需要引入端口机制将各个程序与特定端口号对应，进而实现针对到程序间的数据交互。）</li><li><strong>用户名</strong></li><li><strong>用户名口令</strong>：就是对应的密码。</li></ul><p>在命令提示符下输入:</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -h localhost -u root -p *** -P 3306 #-h后跟主机名 -u后跟用户名 -p后跟口令 -P后跟端口号</div></pre></td></tr></table></figure><p>输入完成后会出现如下一个简单提示：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</div><div class="line">Your MySQL connection id is 3</div><div class="line">Server version: 5.7.19-log MySQL Community Server (GPL)</div><div class="line"></div><div class="line">Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.</div><div class="line"></div><div class="line">Oracle is a registered trademark of Oracle Corporation and/or its</div><div class="line">affiliates. Other names may be trademarks of their respective</div><div class="line">owners.</div><div class="line"></div><div class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure><p>注意，如果连接本地服务器出现错误，请检查本地Mysql服务是否开启，或许需要手动开启服务。后续命令输入在<code>mysql&gt;</code>之后，命令用<code>；</code>结束，输入<code>quit</code>或<code>exit</code>退出Mysql命令行实用程序。</p><h4 id="选择数据库"><a href="#选择数据库" class="headerlink" title="选择数据库"></a>选择数据库</h4><p>　　要知道，在最初连接到Mysql时，没有任何数据库打开供你使用，你需要选择一个数据库进而执行其他数据库操作。如果你不知道可以使用的数据库名，可以使用<code>show</code>关键字来显示数据库信息。下面是一个简单的例子：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">show databases;          #输入</div><div class="line">+<span class="comment">--------------------+   #输出</span></div><div class="line">| Database           |</div><div class="line">+<span class="comment">--------------------+</span></div><div class="line">| information_schema |</div><div class="line">| cda1               |</div><div class="line">| crashcourse        |</div><div class="line">| mysql              |</div><div class="line">| performance_schema |</div><div class="line">| sys                |</div><div class="line">+<span class="comment">--------------------+</span></div><div class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.04</span> sec)</div></pre></td></tr></table></figure><p>此处返回一个数据库列表，列表中是Mysql内部可能使用的数据库。下一步选择你想进入的数据库，如下：</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">use crashcourse;        #输入</div><div class="line">Database changed        #输出</div></pre></td></tr></table></figure><p>注意，<code>use</code>语句不返回任何结果，依赖于使用的客户机软件，显示某种形式的通知。必须先使用<code>use</code>语句打开数据库才能读取其中的数据。</p><h4 id="关于show语句"><a href="#关于show语句" class="headerlink" title="关于show语句"></a>关于show语句</h4><p>　　更多的<code>show</code>语句可以在Mysql命令行实用程序中，执行<code>help show;</code>进行查看，此处列出两个常用<code>show</code>语句：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">show tables;                  #输入</div><div class="line">+<span class="comment">-----------------------+     #输出</span></div><div class="line">| Tables_in_crashcourse |</div><div class="line">+<span class="comment">-----------------------+</span></div><div class="line">| customers             |</div><div class="line">| orderitems            |</div><div class="line">| orders                |</div><div class="line">| productnotes          |</div><div class="line">| products              |</div><div class="line">| vendors               |</div><div class="line">+<span class="comment">-----------------------+</span></div><div class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</div></pre></td></tr></table></figure><p>注意，<code>show tables;</code>返回正在使用的数据库内的表的列表。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">show columns from products;                                    #输入</div><div class="line">+<span class="comment">------------+--------------+------+-----+---------+-------+   #输出</span></div><div class="line">| Field      | Type         | Null | Key | Default | Extra |</div><div class="line">+<span class="comment">------------+--------------+------+-----+---------+-------+</span></div><div class="line">| prod_id    | char(10)     | NO   | PRI | NULL    |       |</div><div class="line">| vend_id    | int(11)      | NO   | MUL | NULL    |       |</div><div class="line">| prod_name  | char(255)    | NO   |     | NULL    |       |</div><div class="line">| prod_price | decimal(8,2) | NO   |     | NULL    |       |</div><div class="line">| prod_desc  | text         | YES  |     | NULL    |       |</div><div class="line">+<span class="comment">------------+--------------+------+-----+---------+-------+</span></div><div class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.12</span> sec)</div></pre></td></tr></table></figure><p>注意，<code>show columns</code>语句要求指定一个数据库内的表名，此例中使用的是products表，它对每个表中的每个字段返回一行（包含了各行数据类型，允许空值与否，主外键，默认值及额外信息）。<code>show columns</code>还有一种快捷方式，使用<code>describe products</code>会返回如上相同的结果。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;　　前一章节介绍了数据库基本概念，在有可使用的服务器和客户机软件之后，连接到数据库是执行后续操作的首要步骤。所有的图形化客户机软件都提供服务器连接窗口，本小白使用的是最原始的Mysql命令行实用程序，后续展现的代码也是基于该客户机工具。&lt;br&gt;
    
    </summary>
    
      <category term="Mysql" scheme="http://prophetjeff.com/categories/Mysql/"/>
    
    
      <category term="Mysql" scheme="http://prophetjeff.com/tags/Mysql/"/>
    
  </entry>
  
  <entry>
    <title>Mysql学习笔记（一）——数据库基础概念</title>
    <link href="http://prophetjeff.com/2017/11/13/mysql-1/"/>
    <id>http://prophetjeff.com/2017/11/13/mysql-1/</id>
    <published>2017-11-13T09:55:00.000Z</published>
    <updated>2017-11-13T09:55:14.622Z</updated>
    
    <content type="html"><![CDATA[<p>　　在写这篇文章之前，我只花了一小段时间大致对《Mysql必知必会》这本小册子翻看了一遍。作为新入坑小白的我知道使用数据库是每位数据科学相关工作者的必备技能，在深入学习之前，理解关于它的基本概念及术语对后续的学习会有很大的帮助。<br><a id="more"></a><br>　　那么，初步接触数据库的第一个问题，十有八九，为什么要学习数据库或者数据有什么用？像这样的问题，作为数学和统计专业出身的我只会微微一笑，当然，数据库毕竟不是单纯的理论。给大家举个例子，假设各位看官开了一家书店，那么如何摆放书籍便于你自己还有前来买书的人搜寻就是一个需要解决的难题。如果说你的书店只卖两本书，那或许考虑怎么摆书是徒劳无功的，但如果你的书店有两万本各不相同书呢？现实情况往往更类似于后者。这样，你就需要将书进行分类以及整理，不同的店家有不同的方法，但需要告诉别人整理摆放的规则使所有的人都能按需检索。现今，有许多企业都拥有非常大规模的数据，虽然它们分别属于不同的行业，但都同样面临管理数据的问题，而数据库技术就能帮助解决这一难题。</p><p>　　要知道其实生活中，我们一直都在使用数据库，比如利用搜索引擎检索、查询自己的银行账户余额等等。数据库技术针对于数据管理，是计算机科学的重要分支。但由于一些原因，不同的人会使用相同的数据库术语表示不同的事物，所以对于本对其就不清楚的小白来说更加混乱。下面，我将列出一些数据库术语并加以说明。</p><h4 id="基本术语："><a href="#基本术语：" class="headerlink" title="基本术语："></a>基本术语：</h4><ul><li><strong>数据库</strong>（Database, DB）：数据库是指一种可共享的，以某种有组织的方式存储在计算机内的数据集合。（简单理解，可以将其想象为是保存有组织数据的容器，比如一个文件夹，是存放数据的物理位置。）</li><li><strong>数据库管理系统</strong>（Database Management System, DBMS）:数据库软件也称为DBMS，通过它我们可以创建和操纵数据库。（通常会看到一些人使用数据库这个术语来代表他们使用的数据库软件，但这是不正确的而且容易引起混淆，因为一般来说我们并不直接访问数据库而是通过DBMS。）</li></ul><p><img src="http://oytj0divs.bkt.clouddn.com/mysql-1.png" alt=""></p><ul><li><strong>SQL</strong>（Structrued Query Language）:结构化查询语言，是一种专门用来与数据库通信的语言。（几乎所有DBMS都支持SQL，它不是由某个特定数据库供应商专有的，但也并非所有语句都是可移植于不同DBMS。）</li><li><strong>表</strong>（table）:某种特定类型数据的结构化清单。（比如，想要将数据放进文件夹，首先需要在其中创建文件，然后将相关的数据放入特定的文件中。可以将数据库中的表想象成这里的文件，表是一种结构化的文件，用来存储某种特定类型的数据，每个表都有一个自己的名字。）</li><li><strong>模式</strong>（schema）:是关于表和数据库信息的特性和结构的信息。（每个表都有一定的特性，这些特性决定了数据在各个表中如何存储，用于描述表的这组信息以及数据库中各个表之间的关系即为模式。）</li><li><strong>列</strong>（column）:表中的一个字段。（表由列组成，每一列都存储着一条特定的信息。比如客户信息表中，客户编号、姓名、住址分别记录于各个列中。将数据有效的分解为多个列是有非常必要的，否则在排序和过滤时会非常困难。）</li><li><strong>行</strong>（row）:表中的一个记录。（例如，客户信息表中每行存储着一个客户。行和记录这两个术语可以互相替代，但从技术层面讲，行才是正确的术语。）</li><li><strong>主键</strong>（primary key）:一列或一组列，其值可以唯一区分表中的每个行。（例如客户信息表中，可用客户编号列作为主键。若没有主键，更新或删除表中特定行将变得困难，因为没有安全的方法保证只涉及相关的行。）</li></ul><h4 id="关于Mysql"><a href="#关于Mysql" class="headerlink" title="关于Mysql"></a>关于Mysql</h4><p>　　前文说到了数据库管理系统，数据的管理、处理实际都是由数据库软件，即DBMS完成的。而Mysql就是DBMS的一种，知名的DBMS还有Oracle,SQL Server,DB2等等。至于为什么选Mysql，见仁见智，首先Mysql是开源的，就好像SAS和R一样（你买得起吗你就学SAS？你的公司买SAS了吗你就学？。。。开源万岁！）。其次，Mysql的使用非常广泛，一些知名企业也使用Mysql来管理自己的数据，它执行快且容易安装和使用。</p><p>　　DBMS可分为两类：一种是共享文件系统的DBMS，一种是基于客户机-服务器的DBMS。前者用于桌面用途，通常不用于高端应用。Mysql即是基于客户机-服务器的DBMS。服务器是负责所有数据访问和处理的一个软件，这个软件运行在称为数据库服务器的计算机上，关于数据添加、删除、更新等请求都由服务器软件来完成。而这些请求来自于运行客户机软件的计算机，它直接和用户交互。比如，你请求检索某数据库中某张表的一个字段，则客户机软件通过网络提交请求给服务器软件，服务器软件处理这个请求并将结果反馈至客户机。（注意：客户机和服务器软件可以安装在不同或同一台计算机上，但要和数据库交互，客户机都要和服务器进行通信。）</p><ul><li>服务器软件为Mysql DBMS。可以在本地安装的副本上运行，也可以连接到运行在你具有访问权限的远程服务器上的副本。</li><li>客户机软件是Mysql提供的工具，如Workbench等。</li></ul><p>　　本菜鸟目前用的是mysql命令行实用程序以及Workbench。前者没有下拉菜单，用户界面及鼠标支持，但它是Mysql核心安装的一部分，简单实用，只需在操作系统命令提示符下输入简单语句即可进入。至于类似Workbench这类图形交互客户机软件有很多，不同人根据自己习惯喜好不同可自行选择，由于我也只用过Workbench就不瞎推荐了。。。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;　　在写这篇文章之前，我只花了一小段时间大致对《Mysql必知必会》这本小册子翻看了一遍。作为新入坑小白的我知道使用数据库是每位数据科学相关工作者的必备技能，在深入学习之前，理解关于它的基本概念及术语对后续的学习会有很大的帮助。&lt;br&gt;
    
    </summary>
    
      <category term="Mysql" scheme="http://prophetjeff.com/categories/Mysql/"/>
    
    
      <category term="Mysql" scheme="http://prophetjeff.com/tags/Mysql/"/>
    
  </entry>
  
  <entry>
    <title>一首令人窒息的诗歌</title>
    <link href="http://prophetjeff.com/2017/11/07/poetry/"/>
    <id>http://prophetjeff.com/2017/11/07/poetry/</id>
    <published>2017-11-07T03:07:11.000Z</published>
    <updated>2017-11-08T02:40:35.604Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://oytj0divs.bkt.clouddn.com/59954a7a7af67.jpg" alt="poetry"><br><blockquote class="blockquote-center"><h1 id="短歌行"><a href="#短歌行" class="headerlink" title="短歌行"></a>短歌行</h1><h4 id="曹操"><a href="#曹操" class="headerlink" title="曹操"></a>曹操</h4><p>对酒当歌，人生几何！譬如朝露，去日苦多。<br><a id="more"></a><br>慨当以慷，忧思难忘。何以解忧？唯有杜康。</p><p>青青子衿，悠悠我心。但为君故，沉吟至今。</p><p>呦呦鹿鸣，食野之苹。我有嘉宾，鼓瑟吹笙。</p><p>明明如月，何时可掇？忧从中来，不可断绝。</p><p>越陌度阡，枉用相存。契阔谈讌，心念旧恩。</p><p>月明星稀，乌鹊南飞。绕树三匝，何枝可依？</p><p>山不厌高，海不厌深。周公吐哺，天下归心。</p></blockquote></p><hr><p>　　《短歌行》是汉乐府的旧题，属于《相和歌辞·平调曲》。这就是说它本来是一个乐曲的名称。最初的古辞已经失传。乐府里收集的同名有24首，最早的是曹操的这首。这种乐曲怎么唱法，现在当然是不知道了。但乐府《相和歌·平调曲》中除了《短歌行》还有《长歌行》，唐代吴兢《乐府古题要解》引证古诗“长歌正激烈”，魏文帝曹丕《燕歌行》“短歌微吟不能长”和晋代傅玄《艳歌行》“咄来长歌续短歌”等句，认为“长歌”、“短歌”是指“歌声有长短”。现在也就只能根据这一点点材料来理解《短歌行》的音乐特点。《短歌行》这个乐曲，原来当然也有相应的歌辞，就是“乐府古辞”，但这古辞已经失传了。现在所能见到的最早的《短歌行》就是曹操所作的拟乐府《短歌行》。所谓“拟乐府”就是运用乐府旧曲来补作新词，曹操传世的《短歌行》共有两首，这里要介绍的是其中的第一首。</p><p>　　这首《短歌行》的主题非常明确，就是作者希望有大量人才来为自己所用。曹操在其政治活动中，为了扩大他在庶族地主中的统治基础，打击反动的世袭豪强势力，曾大力强调“唯才是举”，为此而先后发布了“求贤令”、“举士令”、“求逸才令”等；而《短歌行》实际上就是一曲“求贤歌”、又正因为运用了诗歌的形式，含有丰富的抒情成分，所以就能起到独特的感染作用，有力地宣传了他所坚持的主张，配合了他所颁发的政令。正像曹操的其它诗作如《蒿里行》、《对酒》、《苦寒行》等一样，是政治性很强的诗作，主要是为曹操当时所实行的政治路线和政治策略服务的；然而它那政治内容和意义却完全熔铸在浓郁的抒情意境之中，全诗充分发挥了诗歌创作的特长，准确而巧妙地运用了比兴手法，来达到寓理于情，以情感人的目的。在曹操的时代，他就已经能够按照抒情诗的特殊规律来取得预期的社会效果，这一创作经验显然是值得借鉴的。同时因为曹操在当时强调“唯才是举”有一定的进步意义，所以他对“求贤”这一主题所作的高度艺术化的表现，也应得到历史的肯定。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://oytj0divs.bkt.clouddn.com/59954a7a7af67.jpg&quot; alt=&quot;poetry&quot;&gt;&lt;br&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;h1 id=&quot;短歌行&quot;&gt;&lt;a href=&quot;#短歌行&quot; class=&quot;headerlink&quot; title=&quot;短歌行&quot;&gt;&lt;/a&gt;短歌行&lt;/h1&gt;&lt;h4 id=&quot;曹操&quot;&gt;&lt;a href=&quot;#曹操&quot; class=&quot;headerlink&quot; title=&quot;曹操&quot;&gt;&lt;/a&gt;曹操&lt;/h4&gt;&lt;p&gt;对酒当歌，人生几何！譬如朝露，去日苦多。&lt;br&gt;
    
    </summary>
    
      <category term="杂文" scheme="http://prophetjeff.com/categories/%E6%9D%82%E6%96%87/"/>
    
    
      <category term="poetry" scheme="http://prophetjeff.com/tags/poetry/"/>
    
  </entry>
  
</feed>
